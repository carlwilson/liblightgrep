<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Liblightgrep by strozfriedberg</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Liblightgrep</h1>
        <p>Fast multipattern regular expression searching for digital forensics</p>
        <p class="view"><a href="https://github.com/strozfriedberg/liblightgrep">View the Project on GitHub <small>strozfriedberg/liblightgrep</small></a></p>
        <ul>
          <li><a href="https://github.com/strozfriedberg/liblightgrep/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/strozfriedberg/liblightgrep/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/strozfriedberg/liblightgrep">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1><a id="python-api" class="anchor" href="#python-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lightgrep Python API</h1>
        <h2>Overview</h2>
        <p>The Lightgrep Python bindings are designed to work in Python 2.7+ and 3.4+ 
        in both 32-bit and 64-bit versions. The liblightgrep.dll and support DLL architectures must, however, 
        match the Python architecture otherwise an error will be generated.</p>
        <p>The list of supported encodings can be found at the 
        <a href="http://demo.icu-project.org/icu-bin/convexp">ICU Project website</a>.</p>

<h2>API Concepts</h2>
<table>
<tr><td>Pattern</td><td>A regular expression to be matched.</td></tr>
<tr><td>Pattern Map</td><td>Stores user-defined data for each pattern.</td></tr>
<tr><td>FSM</td><td>Finite State Machine. An intemediate representation of the patterns.</td></tr>
<tr><td>Program</td><td>A compiled version of the FSM.</td></tr>
<tr><td>Search Context</td><td>A handle for conducting a search using a program.</td></tr>
</table>

<h2>Simple Example in Python</h2>

<p>First, let's create some sample text to search (this isn't part of Lightgrep):</p>
<pre>
text = "These aren't the droids you're looking for."
data = text.encode('utf-8')
</pre>

<p>Now define the patterns, or keywords, to search for. A keyword contains a regular expression,
list of encodings, and keyword options. Available keyword options are "fixedString" and "caseInsensitive". 
The default value for both options is False, meaning if you do not specify them, the search for that 
keyword will be GREP and case sensitive.</p>
<pre>
pats = (
    ('droids', ['UTF-8', 'UTF-16LE'], KeyOpts(caseInsensitive = True)),
    ('a.*?t', ['ASCII'], KeyOpts())
)
</pre>

<p>Create an accumulator that will store all hits as they are generated:</p>
<pre>
accum = HitAccumulator()
</pre>

<p>Search the data with the previously defined patterns:</p>
<pre>
with Lightgrep(pats, accum.lgCallback) as lg:
    hitcount = lg.searchBuffer(data, accum)
</pre>

<p>Iterate the list of hits:</p>
<pre>
for h in accum.Hits:
    print('hit on {} in {} at [{} ,{}): "{}"'.format(
        h['pattern'], h['encChain'], h['start'], h['end'],
        data [h['start']:h['end']].decode('utf-8')
    ))
</pre>

<p>Run the script to see the output:</p>
<pre>
$ ./ex.py
hit on a.*?t in ASCII at [6 ,12): "aren't"
hit on droids in UTF-8 at [17 ,23): "droids"
</pre>

<p>Where are the program, pattern map, FSM, search context?
Not in the simple example.</p>

<h2>Advanced example:</h2>

<pre>
text = "These aren't the droids you're looking for."
data = text.encode('utf-8')
pats = (
    ('droids', ['UTF-8', 'UTF-16LE'], KeyOpts(caseInsensitive = True)),
    ('a.*?t', ['ASCII'], KeyOpts())
)
accum = HitAccumulator()
with Lightgrep(pats, accum.lgCallback) as lg:
    hitcount = lg.searchBuffer(data, accum)

for h in accum.Hits:
    print ('hit on {} in {} at [{} ,{}): "{}" '.format (
        h['pattern'], h['encChain'], h['start'], h['end'],
        data [h['start']:h['end']].decode ('utf-8')
    ))

prog, pmap = Lightgrep.createProgram(pats)
lg = Lightgrep()
accum = HitAccumulator()
lg.createContext(prog, pmap, accum.lgCallback)

hitcount = lg.searchBuffer(data, accum)
for h in accum.Hits:
    # do stuff with hits

accum.reset()
lg.reset()

hitcount = lg.searchBuffer(otherdata, accum)
for h in accum.Hits :
    # do stuff with other hits

lg.close()
</pre>


<p>Use Lightgrep in the language you want!*</p>
<p>*As long as the language you want is C, C++, or Python (or you can write your own bindings).</p>


      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/strozfriedberg">strozfriedberg</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
